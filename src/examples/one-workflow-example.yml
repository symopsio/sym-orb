description: >
  An example Circle CI flow that makes a SYM request
usage:
  version: 2.1
  orbs:
    approval: sym/approval@1.0

  jobs:
    prod-deploy:
      docker:
        - image: cimg/base:stable
      steps:
        - run:
            command: echo "Deploying to prod"

  workflows:
    sym-approval-example:
      jobs:
        - approval/request:
            flow_srn: "healthy-health:flow:ci-deploy-prod:latest"
            flow_inputs: '{
                            "build_url": "${CIRCLE_BUILD_URL}",
                            "duration": 3600,
                            "target_srn": "healthy-health:access_target:custom:ci-deploy-target:latest"
                          }'
            request_slug: "prod-deploy"
        - wait_for_approve_hook:
            type: approval
            requires:
              - approval/request
        - prod-deploy:
            requires:
              - wait_for_approve_hook
        - approval/deescalate:
            request_slug: "prod-deploy"
            requires:
              - prod-deploy
